## 2025-09-10 - UI Overhaul + Fixes

- Fixed white screen caused by missing React import in `JobForm` and bumped SW cache to avoid stale assets.
- Disabled service worker in development and auto-`unregister old SWs.
- Design refresh: expanded theme tokens, shadows, table styles, dark theme.
- New components: ErrorBoundary, ToastProvider (`useToast`), ThemeToggle, GlobalSearch with "/" shortcut.
- Header: grouped actions (Search, Dark, Field Mode, Sync), added Help and 404 routes.
- Dashboard: converted Recent Jobs into sortable/filterable table.
- Cleaned garbled text in multiple components (Weather, Summary, Job, Offline, ChemLookup).
- Print styles for better Job Summary PDF.
- Settings: real Supabase config check via `isSupabaseConfigured`.
- Added `.env.local` for Supabase (URL + anon key) to mark as configured (restart dev server to pick up changes).

## 2025-09-10 - UI Overhaul + Features
- Fixed blank-screen (missing import) and SW cache bust; disabled SW in dev.
- Design refresh: theme tokens, dark mode, header refactor.
- Added ErrorBoundary, Toasts, Global Search (with "/" shortcut).
- Dashboard: jobs table + actions (summary, delete cascade).
- Map: GPS accuracy, track length, export GPX.
- Settings: Supabase env + Test Connection.
- New routes: Fishery (tap-to-count), Chemical Ref + % calculator, Time Tracking.
- Cleaned mojibake; print styles for Job Summary.
## 2025-09-10 - Web QA Agent + Guards
- Added non-invasive web-qa-agent under tools/web-qa-agent with Playwright smoke + a11y, Lighthouse, Linkinator, Markdown report.
- CI workflow .github/workflows/web-qa.yml runs QA on PRs touching the agent or on schedule.
- Guarded Playwright tests to block all external network calls (only same-origin allowed).
- Added verify step to ensure report is written and warn on excessive duplicates.
- Confirmed local run: npm run qa writes out/report.md.
## 2025-09-10 - Dev Runner Helper
- Added tools/dev-runner/run.mjs to start the dev server, wait until reachable, optionally run QA (BASE_URL), and stop if requested.
- Logs written to tools/dev-runner/out/*.log.
## 2025-09-10 - Intensive Session Summary (UI, Tools, Map, QA, Runner)

- Server Operations (Session Policy)
  - Keep server running for entire session at http://localhost:5173/.
  - I will only restart to prevent a crash; otherwise it stays up.
  - Startup logs are written to markdowns/KEEP/vite-dev.*.log.

- Navigation & Structure
  - Header: Dashboard, Map, Offline, Tools, Settings, Help.
  - Tools landing page now links to: Calculators, Fishery Study, Chemical Reference, Time Tracking, Water Quality, Acreage Tools, Profile, Reset App Cache.
  - Calculators moved from Dashboard to a dedicated Tools page (/calculators).

- Calculators
  - Removed "chemical dosing example".
  - Added: Pump Time (volume vs gpm + hours/min), Unit Conversions (ft↔m, gal↔L, ac↔ft^2), Percent Mix (tank gal + % + gal + fl oz).
  - File: apps/vplm-portal/src/components/CalcPanel.tsx; page: apps/vplm-portal/src/routes/calculators.tsx.

- Tools Enhancements (History & Save)
  - Acreage Tools (image-based): Save Trace (image snapshot + scale + polygon + name + ts), Load Latest, Saved Traces list. Activity log entries for save/load.
  - Fishery Study: Previous Sessions below the tool; open/resume a session; activity logged for start/end/count changes.
  - DB: added acreage traces table and helpers (save/list/get). File: src/features/offline/db.ts.

- Polygon Tracing Accuracy
  - Acreage Tools click mapping fixed: exact vertex placement under cursor using canvas natural size and proper coordinate scaling.
  - Canvas sized to image naturalWidth/Height to prevent distortion.

- Map
  - Aerial basemap (Esri World Imagery) on Map tab and Job + Map & GPS.
  - Plain Leaflet (no react-leaflet) to avoid hooks/runtime errors.
  - Auto fit-to-pins on Map tab; lightweight clustering toggle groups sites at low zooms (no external deps).

- Weather
  - Now on-demand only with a "Get Weather" button; uses imperial units (°F, mph).
  - Hidden unless job has coordinates.
  - Settings shows Present if env key or locally saved key; key can be entered without restart.

- Activity Log
  - Logs recorded for: job updates, tasks add/toggle, time clock in/out, note add, measurement add, photo add, safety checklist save, GPS track save, acreage save/load, fishery start/end/counts.
  - New "Activity Log" panel in Job; "Details" panel for editing job.

- QA Agent (non-invasive)
  - tools/web-qa-agent: Playwright smoke + axe, Lighthouse, Linkinator, report.md.
  - Playwright tests block all external requests (same-origin only) to prevent unintended API calls.
  - CI workflow .github/workflows/web-qa.yml triggers on PRs touching agent or on schedule.
  - verify.mjs ensures out/report.md exists and warns on suspicious duplicates.

- Dev Runner
  - tools/dev-runner/run.mjs can start server, wait for readiness, optional QA, then stop (or keep running).

- Moves and Cleanups
  - Calculators removed from Dashboard; new /calculators route under Tools.
  - Tools page expanded links.
  - Misc mojibake/label cleanup; NotFound text normalized.

- Known/Follow-ups
  - If clicking a client name still errors, capture the first console line for pinpoint fix.
  - Optional: Water Quality export CSV; Tools Logs page aggregating tools actions; marker clustering enhancements.

